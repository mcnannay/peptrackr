generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model User {
  id        Int       @id @default(autoincrement())
  name      String
  createdAt DateTime  @default(now())
  updatedAt DateTime  @updatedAt

  weights   Weight[]
  shots     Shot[]
}

model Medication {
  id                      Int       @id @default(autoincrement())
  name                    String    @unique
  halfLifeHours           Float
  absorptionHalfLifeHours Float     // "kh" style absorption half-life
  freqDays                Int       @default(7) // default weekly

  shots    Shot[]
}

model Shot {
  id        Int       @id @default(autoincrement())
  user      User      @relation(fields: [userId], references: [id])
  userId    Int
  medication Medication @relation(fields: [medId], references: [id])
  medId     Int
  doseMg    Float
  takenAt   DateTime   @default(now())
  createdAt DateTime   @default(now())
}

model Weight {
  id        Int       @id @default(autoincrement())
  user      User      @relation(fields: [userId], references: [id])
  userId    Int
  valueKg   Float
  takenAt   DateTime   @default(now())
  createdAt DateTime   @default(now())
}

model Settings {
  id        Int       @id @default(1)
  theme     String    @default("dark")
  currentUserId Int?
}
